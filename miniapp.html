<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Mini TV</title>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <style>
    body { background:#111; color:white; font-family:sans-serif; text-align:center; }
    video { width:100%; max-height:70vh; margin:10px 0; border:2px solid #444; border-radius:10px; }
    select { padding:10px; margin:10px; font-size:16px; }
  </style>
</head>
<body>
  <h2>ğŸ“º Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</h2>

  <label>Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ:</label>
  <select id="categoryList"></select>

  <label>Ø§Ø®ØªØ± Ø§Ù„Ù‚Ù†Ø§Ø©:</label>
  <select id="channelList"></select>

  <video id="video" controls autoplay></video>

  <script>
    let channelsData = {};

    async function loadChannels() {
      let res = await fetch("channels.json");
      channelsData = await res.json();

      let catSelect = document.getElementById("categoryList");
      catSelect.innerHTML = "";

      Object.keys(channelsData).forEach((cat, i) => {
        let opt = document.createElement("option");
        opt.value = cat;
        opt.textContent = cat;
        if(i===0) opt.selected = true;
        catSelect.appendChild(opt);
      });

      loadChannelsByCategory(catSelect.value);
      catSelect.onchange = () => loadChannelsByCategory(catSelect.value);
    }

    function loadChannelsByCategory(cat) {
      let chanSelect = document.getElementById("channelList");
      chanSelect.innerHTML = "";

      channelsData[cat].forEach((ch, i) => {
        let opt = document.createElement("option");
        opt.value = ch.url;
        opt.textContent = ch.name;
        if(i===0) opt.selected = true;
        chanSelect.appendChild(opt);
      });

      play(chanSelect.value);
      chanSelect.onchange = () => play(chanSelect.value);
    }

    function play(url) {
      let video = document.getElementById("video");
      if(Hls.isSupported()) {
        let hls = new Hls();
        hls.loadSource(url);
        hls.attachMedia(video);
      } else if(video.canPlayType("application/vnd.apple.mpegurl")) {
        video.src = url;
      }
    }

    loadChannels();
  </script>
</body>
</html>
